<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Main Window</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  </head>
  <body>
    <h1>Main Window (Simple Mode)</h1>

    <article>
      <h2>Using Authenticated iframe Window</h2>
      <iframe src="http://wmrm-op.dev/authenticated.html?client_id=abc&state=state-for-authenticated&resonse_type=token&response_mode=web_message&redirect_uri=http://wmrm-rp.dev"></iframe>
      <script>
        $(window).on('message', function (event) {
          event = event.originalEvent;
          if (event.origin != 'http://wmrm-op.dev')
            console.error('invalid origin', event.origin);
          if (event.data && event.data.type == 'authorization_response')
            console.info('From Authenticated Window', event.data);
          $(window).off('message', arguments.callee);
        });
      </script>
    </article>

    <article>
      <h2>Using Unauthenticated Popup Window</h2>
      <a id="unauthenticated-link" href="http://wmrm-op.dev/unauthenticated.html?client_id=abc&state=state-for-unauthenticated&resonse_type=token&response_mode=web_message&redirect_uri=http://wmrm-rp.dev">
        Open Unauthenticated Popup Window
      </a>
      <script>
        $('#unauthenticated-link').click(function () {
          window.open($(this).attr('href'), '_unauthenticated', 'width=500, height=400');
          $(window).on('message', function (event) {
            event = event.originalEvent;
            if (event.origin != 'http://wmrm-op.dev')
              console.error('invalid origin', event.origin);
            if (event.data && event.data.type == 'authorization_response')
              console.info('From Unauthenticated Window', event.data);
            $(window).off('message', arguments.callee);
            event.source.close();
          });
          return false;
        });
      </script>
    </article>
  </body>
</html>