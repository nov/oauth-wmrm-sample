<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Main Window</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  </head>
  <body>
    <h1>Main Window</h1>

    <section>
      <h2>Simple Mode</h2>

      <article>
        <h3>Using Authenticated iframe Window (Simple Mode)</h3>
        <iframe src="http://wmrm-op.dev/authenticated.html"></iframe>
        <script>
          $(window).on('message', function (event) {
            event = event.originalEvent;
            if (event.origin != 'http://wmrm-op.dev')
              console.error('invalid origin', event.origin);
            if (event.data && event.data.type == 'authorization_response')
              console.info('Successful AuthZ Response from Authenticated iframe Window', event.data);
          });
        </script>
      </article>

      <article>
        <h3>Using Unauthenticated Popup Window</h3>
        <a id="unauthenticated-link" href="http://wmrm-op.dev/unauthenticated.html">Open Unauthenticated Popup Window</a>
        <script>
          $('#unauthenticated-link').click(function () {
            window.open($(this).attr('href'), '_unauthenticated', 'width=500, height=400');
            $(window).on('message', function (event) {
              event = event.originalEvent;
              if (event.origin != 'http://wmrm-op.dev')
                console.error('invalid origin', event.origin);
              if (event.data && event.data.type == 'authorization_response')
                console.info('Successful AuthZ Response from Unauthenticated Popup Window', event.data);
              event.source.close();
            });
            return false;
          });
        </script>
      </article>
    </section>
  </body>
</html>